{{- $profile := .Site.Params.home.profile -}}
<div class="home-profile">
    {{- /* 1. 头像 */ -}}
    {{- $avatar := $profile.avatarURL -}}
    {{- if $avatar -}}
        <div class="home-avatar">
            {{- $menus := $.Site.Menus.main | default slice -}}
            {{- with index $menus 0 -}}
                <a href="{{ .URL | relLangURL }}">{{- dict "Src" $avatar | partial "plugin/image.html" -}}</a>
            {{- else -}}
                {{- dict "Src" $avatar | partial "plugin/image.html" -}}
            {{- end -}}
        </div>
    {{- end -}}

    <h1 class="home-title">{{- $profile.title | default .Site.Title | safeHTML -}}</h1>

    {{- /* 2. 副标题 */ -}}
    {{- with $profile.subtitle -}}
        <div class="home-subtitle">
            {{- if $profile.typeit -}}
                {{- $id := dict "Content" . "Scratch" $.Scratch | partial "function/id.html" -}}
                <div id="{{ $id }}" class="typeit"></div>
                {{- dict $id (slice $id) | dict "typeitMap" | merge ($.Scratch.Get "this") | $.Scratch.Set "this" -}}
            {{- else -}}
                {{- . | safeHTML -}}
            {{- end -}}
        </div>
    {{- end -}}

    {{- /* 3. 社交图标 (对齐强化版) */ -}}
    {{- if $profile.social -}}
        <div class="links">
            {{- $socialMap := resources.Get "data/social.yml" | transform.Unmarshal -}}
            {{- range $key, $value := .Site.Params.social -}}
                {{- if $value -}}
                    {{- $keyLower := $key | lower -}}
                    {{- $svgPath := printf "svg/%v.svg" $key -}}
                    {{- $customSvg := resources.Get $svgPath -}}
                    {{- if not $customSvg -}}
                        {{- $customSvg = resources.Get (printf "svg/%v.svg" $keyLower) -}}
                    {{- end -}}

                    <div class="icon-wrapper">
                        {{- if $customSvg -}}
                            <a href="{{ if reflect.IsMap $value }}{{ $value.prefix }}{{ $value.id }}{{ else }}{{ $value }}{{ end }}" title="{{ $key }}" target="_blank" rel="noopener noreffer me">
                                <span class="custom-icon {{ $keyLower }}">
                                    {{- $customSvg.Content | safeHTML -}}
                                </span>
                            </a>
                        {{- else -}}
                            {{- $social := index $socialMap $keyLower | default dict -}}
                            {{- if reflect.IsMap $value -}}
                                {{- $social = merge $social $value -}}
                            {{- else if ne $value true -}}
                                {{- $social = dict "Id" $value | merge $social -}}
                            {{- end -}}
                            {{- partial "plugin/social.html" $social -}}
                        {{- end -}}
                    </div>
                {{- end -}}
            {{- end -}}
        </div>
    {{- end -}}
</div>

<style>
    /* 1. 社交链接容器：确保图标行内居中 */
    .links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        margin-top: 1.2rem;
    }

    /* 2. 统一图标外框：不管是什么图标，外框必须一样大 */
    .icon-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 2.5rem;
        height: 2.5rem;
    }

    /* 3. 修正主题自带的 FontAwesome 邮箱图标 */
    .icon-wrapper .social-icon i {
        font-size: 2.2rem !important; /* 强制拉大邮箱图标 */
        display: block;
        line-height: 2.5rem;
    }

    /* 4. 修正自定义 SVG 图标 (微信/小红书) */
    .custom-icon {
        display: flex;
        width: 100%;
        height: 100%;
        fill: currentColor;
        align-items: center;
        justify-content: center;
    }

    .custom-icon svg {
        width: 2.2rem; /* 微信宽度与邮箱一致 */
        height: auto;
    }

    /* 5. 针对小红书单独放大，因为它的 SVG 比例通常很小 */
    .custom-icon.xhs svg {
        transform: scale(2.2); 
        transform-origin: center;
    }

    .icon-wrapper a {
        text-decoration: none;
        transition: transform 0.2s;
    }

    .icon-wrapper a:hover {
        transform: scale(1.15);
    }
</style>
